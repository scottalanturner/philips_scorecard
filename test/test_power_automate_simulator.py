import sys
import argparse
import os
import json
import base64

sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from philips_scorecard.build_scorecard import *

from philips_scorecard.utils.doc_converters import word_to_base64
from philips_scorecard.config.config_loader import ConfigLoader
from philips_scorecard.database.azure_client import AzureClientMSSQL

def test_db_con():
    try:
        # Load configuration
        config_loader = ConfigLoader()
        db_config = config_loader.load_database_config()
        
        # Initialize Azure client
        azure_client = AzureClientMSSQL(server=db_config.server, 
                                        database=db_config.database, 
                                        username=db_config.username,
                                        password=db_config.password)
        
        # Load data
        df = azure_client.load_table_to_dataframe("philips_rules")
        
    except Exception as e:
        print(f"Error: {str(e)}")
        raise


def test_convert_response():
    # Test/Run the function from a browser and copy the HTTP response content from the output here.
    json_response ="{\"new_document_content\": \"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\"}"

    # Parse the JSON response
    response_data = json.loads(json_response)
    
    # Extract the 'content' field which is base64 encoded
    document_content_modified_base64 = response_data['new_document_content']

    # Decode the base64 content to get the binary data
    document_content_modified = base64.b64decode(document_content_modified_base64)

    # Save the modified document to a new file. This is done locally for testing to verify the .docx is correct
    with open("io/updated_result.docx", "wb") as new_file:
        new_file.write(document_content_modified)
    print("Document saved to updated_result.docx")

def create_test_input():
    # Create a JSON object to simulate the input to the Azure. This file is relative to running the code in
    # philips_scorecard and executing: python test/power_automate_simulator.py
    input_template_name = 'io/philips_scorecard_template.docx'
    # Load the Word document template and convert to base64, just for testing.
    document_content_base64 = word_to_base64(input_template_name)   

    # Create the JSON object
    json_data = {
        "document_content": document_content_base64,
        "form_row_id": 24
    }     
    # Convert the JSON object to a JSON string
    json_string = json.dumps(json_data, indent=4)

    print(json_string)

def test_build_doc():

    # Get the directory of the current script
    current_dir = os.path.dirname(os.path.abspath(__file__))

    # Build the full path to the file
    input_template_name = 'philips_scorecard/io/philips_scorecard_template.docx'
    ouput_template_name = 'philips_scorecard/io/updated_result.docx'

    # Create a JSON object to simulate the input to the Azure. This file is relative to running the code in
    # philips_scorecard and executing: python test/power_automate_simulator.py
    #input_template_name = 'io/philips_scorecard_template.docx'
    # Load the Word document template and convert to base64, just for testing.
    document_content_base64 = word_to_base64(input_template_name)   

    # Create the JSON object
    json_data = {
        "document_content": document_content_base64,
        "form_row_id": 24
    }     
    # Convert the JSON object to a JSON string
    json_request = json.dumps(json_data, indent=4)

    # Calling azure which sends back a json response, base64 encoded document
    json_response = build_scorecard(json_request)

    # Parse the JSON response
    response_data = json.loads(json_response)

    # Extract the 'content' field which is base64 encoded
    document_content_modified_base64 = response_data['new_document_content']

    # Decode the base64 content to get the binary data
    document_content_modified = base64.b64decode(document_content_modified_base64)

    # Save the modified document to a new file. This is done locally for testing to verify the .docx is correct
    with open(ouput_template_name, "wb") as new_file:
        new_file.write(document_content_modified)
    print("Document saved to updated_result.docx")



if __name__ == "__main__":
#    test_db_con()
    parser = argparse.ArgumentParser(description="Power Automate Simulator")
    parser.add_argument("action", choices=["db_test", "create_input", "process_output", "build_doc"], help="Action to perform")
    args = parser.parse_args()

    if args.action == "db_test":
        test_db_con()
    elif args.action == "create_input":
        create_test_input()
    elif args.action == "process_output":
        test_convert_response()
    elif args.action == "build_doc":
        test_build_doc()


    # Calling azure which sends back a json response, base64 encoded document
    #response = call_azure_function(json=json_string)

    # Parse the JSON response
    #response_data = json.loads(response)

    # Extract the 'content' field which is base64 encoded
    #document_content_modified_base64 = response_data['new_document_content']

    # Decode the base64 content to get the binary data
    #document_content_modified = base64.b64decode(document_content_modified_base64)

    # Save the modified document to a new file. This is done locally for testing to verify the .docx is correct
    #with open("io/updated_result.docx", "wb") as new_file:
    #    new_file.write(document_content_modified)
    #print("Document saved to updated_result.docx")